В данном репозитории представлено простое решение кейса, в рамках которого нужно было построить алгоритм, оценивающий вероятность отзыва банковской лицензии.

Описание кейса.
Цель - прогнозировать отзывы банковских лицензий.
Задачи:
1. Построить модель, которая могла бы не только выдавать вероятности отзыва, но и говорить о том, когда это произойдёт (завтра, через полгода, через год и т.д.);
2. Для каждого банка нужно иметь возможность следить, как изменялись наши прогнозы с течением времени (по состоянию на разные даты);
3. Должна быть возможность сценарного моделирования влияния макроэкономики на отзывы лицензий (что произойдёт с вероятностями, если изменятся инфляция, ключевая ставка ЦБ, курсы валют и др.).

Предпосылки на модель:
1. Мы верим в нейронные сети;
2. Мы ленивы.

Следствия:
1. Создаем одну крутую рекурсивную нейронную сеть;
2. Модель сама выберет важные переменные (поэтому мы подаем все признаки, что есть);
3. Модель научится распознавать отзывы лицензий не только по финансовым причинам, но и по причине незаконной деятельности (поэтому мы подаем все банки, что есть).

Источники данных:
1. banki.ru — финансовые показатели;
2. rbc.ru — макроэкономические показатели;
3. cbr.ru — соответствие нормативам.

Итоговый формат данных:
1. Отдельная таблица для каждого банка;
2. Столбцы — различные показатели;
3. Строки — значения показателей за каждый месяц.

Целевая переменная:
1. Для каждого банка для каждого месяца вводится набор целевых переменных:
  y0 - лицензию отзовут в течение месяца,
  у1 - в течение трех,
  у2 - в течение 6,
  у3 - в течение 9,
  у4 - в течение 12,
  у5 - в течение 18,
  у6 - в течение 24,
  у7 - в течение 36,
  y8 - лицензию не отзовут в течение 36 месяцев;
2. Переменная принимает значение 1, если событие произойдет. 0, если нет. -1, если на данный момент точно не известно, произойдет ли событие.

Итого по данным:
1. 1116 банков: 553 закрывшихся и 563 открытых на данный момент;
2. 75266 наблюдений;
3. 58 признаков: 20 макроэкономических показателей, 10 нормативов и 28 финансовых показателей банка;
4. Разбиваем банки на обучающую и тестовую выборку в отношении 80/20 с сохранением пропорции закрывшихся банков.

Предсказывающая модель:
1. Рекурсивная нейронная сеть на базе LSTM;
2. Функция потерь — категориальная кросс-энтропия;
3. Позволяет отслеживать историю предсказаний;
4. Позволяет оценивать вероятности классов.
